{% extends "./base.html" %}

{% load static %}

{% block title %}
  {{ block.super }} - Charts
{% endblock %}

{% block content %}
  <h2>Charts</h2>

  <form action="{{ request.path }}" method="GET">
    <input name="account" type="text" value="{{ account }}" />
    <input type="submit" value="Show" />
  </form>

  <canvas id="chart"></canvas>

  <script src="{% static "Chart.min.js" %}"></script>
  <script>
   var plot_x = JSON.parse("{{ plot_x|escapejs }}");
   var expenses_y = JSON.parse("{{ expenses_y|escapejs }}");
   var income_y = JSON.parse("{{ income_y|escapejs }}");

   var ctx = document.getElementById('chart').getContext('2d');
   var myChart = new Chart(ctx, {
     type: 'line',
     data: {
       labels: Object.values(plot_x),
       datasets: [
         {
           label: 'Expenses{% if account %} =~ /{{ account }}/{% endif %}',
           data: Object.values(expenses_y),
           borderColor: 'rgba(255, 100, 100, 0.5)',
           backgroundColor: 'rgba(255, 100, 100, 0.1)'
         },
         {
           label: 'Income',
           data: Object.values(income_y),
           borderColor: 'rgba(50, 200, 50, 1)',
           backgroundColor: 'rgba(50, 200, 50, 0.1)'
         }
       ]
     },
     options: {
       scales: {
         yAxes: [{
           ticks: {
             beginAtZero: true
           }
         }]
       }
     }
   });
  </script>
{% endblock %}

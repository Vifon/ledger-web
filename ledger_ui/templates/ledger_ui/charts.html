{% extends "./base.html" %}

{% load static %}

{% block title %}
  {{ block.super }} - Charts
{% endblock %}

{% block head %}
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script src="https://underscorejs.org/underscore-min.js"></script>
  <script src="{% static "Chart.min.js" %}"></script>
{% endblock %}

{% block content %}
  <h2>Charts</h2>

  <form action="{{ request.path }}" method="GET">
    <input name="account_filter" type="text" value="{{ account_filter }}" />
    <input type="submit" value="Filter Expenses" />
  </form>

  <div class="chart-container">
    <canvas id="timechart"></canvas>
  </div>

  <div id="slider-range"></div>
  <div>
    <div style="float: left">
      <input type="text"
             id="range-text1"
             readonly
             style="border:0; color:#f6931f; font-weight:bold; text-align:left;">
    </div>
    <div style="float: right">
      <input type="text"
             id="range-text2"
             readonly
             style="border:0; color:#f6931f; font-weight:bold; text-align:right;">
    </div>
  </div>
  <div style="clear:both"></div>

  <div class="chart-container">
    <canvas id="piechart"></canvas>
  </div>

  <script>
   const dates = Object.values(JSON.parse("{{ dates|escapejs }}"));
   const expensesTotals = Object.values(JSON.parse("{{ expenses_totals|escapejs }}"));
   const incomeTotals = Object.values(JSON.parse("{{ income_totals|escapejs }}"));
   const expensesFlat = JSON.parse("{{ expenses|escapejs }}").data;
  </script>
  <script src="{% static "charts.js" %}"></script>
{% endblock %}
